{"version":3,"sources":["components/FileField.jsx","components/CheckBox.jsx","components/PreviewProcessedData.jsx","utils.js","App.jsx","index.js"],"names":["FileField","onChange","useState","filesNumber","setFilesNumber","filesNameList","setFilesNameList","inputFileLabel","className","type","id","event","files","target","length","name","filesData","i","reader","FileReader","onload","push","result","readAsText","accept","multiple","htmlFor","CheckBox","value","checked","PreviewProcessedData","data","sheetToArrayBuffer","s","buf","ArrayBuffer","view","Uint8Array","charCodeAt","App","fileData","setFileData","processedData","setProcessedData","checkboxState","setCheckboxState","disabled","onClick","map","el","JSON","parse","r1","r2","ils","fzl","izl","ozl","dto1","dfr21","isSplited","wb","XLSX","utils","book_new","SheetNames","ws_header","ws_data_set","flat","person","Object","keys","key","Sheets","aoa_to_sheet","forEach","index","ws_data","write","bookType","createExcelFile","saveAs","Blob","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d0e71c82.chunk.js","sourcesContent":["import React, {useState} from 'react';\nimport { Paperclip } from 'react-feather';\n\nconst FileField = ({onChange}) => {\n    const [filesNumber, setFilesNumber] = useState(null);\n    const [filesNameList, setFilesNameList] = useState(null);\n    \n    const onFileChangeHandler = (event) => {\n        const {files} = event.target;\n        setFilesNumber(files.length)\n        setFilesNameList(files[0].name)\n        \n        if (files !== ' ') {\n            \n            if (files.length) {\n\n                let filesData = [];\n                let i = 0;\n\n                const reader = new FileReader();\n                reader.onload = (event) => {\n                    i++; \n                    filesData.push(event.target.result);    \n                    if (i < files.length) reader.readAsText(files[i]);\n                    if (i === files.length) onChange(filesData);\n                }           \n\n                if (i === 0) reader.readAsText(files[0]);\n            }\n        }\n    }\n\n    const inputFileLabel = filesNumber > 1\n        ? `Выбрано файлов: ${filesNumber}` \n        : (filesNumber === 1) \n            ? filesNameList\n            : <>Выбрать файлы <Paperclip/></>\n    \n    return (\n        <div className = \"input-field\">\n            <p>Шаг 1</p>\n            <input  type=\"file\" \n                    id=\"inputFile\" \n                    onChange={onFileChangeHandler} \n                    accept=\" .txt\" \n                    multiple=\"multiple\"/>\n            <label htmlFor=\"inputFile\" className=\"input-field-label\"> \n                    {inputFileLabel}\n            </label>\n            \n        </div>\n    )\n}\n\nexport default FileField;","import React from 'react';\n\nconst CheckBox = ({value, onChange}) => {\n    const onChangeHandler = (event) => {\n        onChange(event.target.checked);\n    }\n\n    return (\n        <div className =\"checkbox-container\">\n            <input type=\"checkbox\" id=\"checkbox\" className=\"checkbox\" value={value} onChange={onChangeHandler}/>\n            <label htmlFor=\"checkbox\" className=\"checkbox-label\">Отображать каждый файл на отдельном листе</label> \n        </div>\n    )\n}\n\n\nexport default CheckBox;","const PreviewProcessedData = ({data}) => {\n    if (!data) return null;\n\n    return (\n        <div className=\"processed-data-message\">Данные обработаны!</div>\n    );\n}\n\nexport default PreviewProcessedData","import XLSX from \"xlsx\";\nimport { saveAs } from 'file-saver';\n\nconst getProcessedData = initialData => initialData\n  .map(el => JSON.parse(el)\n    .data\n    .map(({r1, r2, ils, fzl, izl, ozl}) => ({\n          ils: {\n            value: ils || \"\",\n            name: \"Страховой номер\"\n          }, \n          fzl: {\n            value: fzl || \"\",\n            name: \"Фамилия\"\n          },\n          izl: {\n            value: izl || \"\",\n            name: \"Имя\"\n          },\n          ozl: {\n            value: ozl || \"\",\n            name: \"Отчество\"\n          },\n          dto1: {\n            value: r1[0].dto1 || \"\",\n            name: \"Дата увольнения\"\n          },\n          dfr21: {\n            value: r2[0].dfr21 || \"\",\n            name: \"Дата приема - перевода\"\n          },\n        }))\n      )\n\n\nconst createExcelFile = (data, isSplited) => {\n    let wb = XLSX.utils.book_new();\n    wb.SheetNames.push(\"Свод\");\n\n    const ws_header = ['Страховой номер','Фамилия','Имя','Отчество','Дата увольнения','Дата приема - перевода'];\n    const ws_data_set = data.flat().map((person) => Object.keys(person).map(key => ([\n        [person[key].value]])));\n\n    wb.Sheets[\"Свод\"] = XLSX.utils.aoa_to_sheet([ws_header, ...ws_data_set]);\n\n    if (isSplited) {\n      data.forEach((el, index) => {\n        wb.SheetNames.push(`Sheet ${index+1}`)\n        const ws_data = el.map((person) => Object.keys(person).map(key => ([\n          [person[key].value]])));\n        wb.Sheets[`Sheet ${index+1}`] = XLSX.utils.aoa_to_sheet([ws_header, ...ws_data]);\n      })\n    }\n\n    return XLSX.write(wb, {bookType:'xlsx',  type: 'binary'});\n  } \n\nconst sheetToArrayBuffer = (s) => {\n  const buf = new ArrayBuffer(s.length);\n  let view = new Uint8Array(buf);\n  for (let i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;\n\n  return buf;    \n}     \n\nconst downloadExcelFile = (data) => {\n  saveAs(new Blob([sheetToArrayBuffer(data)],{type:\"application/octet-stream\"}), 'test.xlsx');\n}\n\n\n\nexport { createExcelFile, downloadExcelFile, getProcessedData }\n\n\n  \n","import React, {useState} from \"react\";\n\nimport FileField from \"./components/FileField\";\nimport CheckBox from \"./components/CheckBox\";\n\nimport PreviewProcessedData from \"./components/PreviewProcessedData\";\n\nimport {createExcelFile, downloadExcelFile, getProcessedData} from \"./utils.js\"\n\nimport { Download } from 'react-feather';\n\nconst App = () => {\n  const [fileData, setFileData] = useState(null);\n  const [processedData, setProcessedData] = useState(null);\n  const [checkboxState, setCheckboxState] = useState(false);\n\n  return (\n    <div className=\"App\">\n\n      <div className=\"file-field-and-checkbox\">\n      <FileField\n        onChange={setFileData}\n      />\n\n      <CheckBox\n        value={checkboxState}\n        onChange={setCheckboxState}\n      />\n      </div>\n\n      <div className=\"process-button\">\n        <p>Шаг 2</p>\n        <button \n          disabled={!fileData}   \n          onClick={() => setProcessedData(\n            getProcessedData(fileData)\n          )}>\n          Обработать файлы\n        </button>\n        <PreviewProcessedData data={processedData}/>\n      </div>\n\n      <div className=\"download-button\">\n        <p>Шаг 3</p>\n        <button \n          disabled={!processedData}\n          onClick={() => downloadExcelFile(createExcelFile(processedData, checkboxState))}>\n          <span>Скачать <Download/></span>\n        </button>\n      </div>\n      \n    </div>\n  );\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nimport './index.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}